@{
    ViewBag.Title = "Home Page";
}
@using Finch_Inventory.Models;



<div class="row">
    <div class="col-lg-12">
        <div class="row">
            <div class="col-lg-12 mt-2">
                <div id="main-console" class="mt-2 rounded p-3 col-lg-12">
                    <a href="~/Clothing/Create" class="btn btn-success mx-2" title="Receive Clothing/Roll"><i class="fas fa-plus mx-2"></i>Receive Roll</a>
                    <a href="#" id="audit-report-btn" class="btn btn-secondary ml-5 mr-2 pull-right" title="Generate Inventory Audit Report"><i class="fas fa-file-pdf mx-2"></i>Weekly Inventory</a>
                    <a href="@Url.Action("WeeklyClothingAging","Reports")" target="_blank" class="btn btn-secondary mx-2 pull-right" title="Generate Weekly PM Clothing Report"><i class="fas fa-file-pdf mx-2"></i>Weekly PM Clothing</a>
                </div>

            </div>
        </div>
        <div class="card card-primary mt-3">
            <div class="card-header">
                <h2><i class="fas fa-clipboard-list mx-2"></i>Clothing/Roll Tracking</h2>
            </div>
            <div class="card-body">
                <table id="inventory_table" class="table table-striped">
                    <thead>
                        <tr>
                            <th>PM_Number</th>
                            <th>Position</th>
                            <th>Serial Number</th>
                            <th>Type</th>
                            <th>Status</th>
                            <th>Age</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{

                            foreach (Clothing item in ViewBag.Inventory)
                            {
                                var dateReceived = new DateTime();
                                var datePlaced = new DateTime();
                                var dateRemoved = new DateTime();
                                var location = string.Empty;
                                if (item.Date_Received != null)
                                {
                                    dateReceived = (DateTime)item.Date_Received;
                                }
                                if (item.Date_Placed_On_Mac != null)
                                {
                                    datePlaced = (DateTime)item.Date_Placed_On_Mac;
                                }
                                if (item.Date_Removed_From_Mac != null)
                                {
                                    dateRemoved = (DateTime)item.Date_Removed_From_Mac;
                                }
                                if (item.Location != null)
                                {
                                    location = item.Location.Location1;
                                }

                                <tr>
                                    <td>@item.PM_Number</td>
                                    <td>@item.Position.Position1.ToUpper()</td>
                                    <td>@item.Serial_Number</td>
                                    <td>@item.Type.Type1.ToUpper()</td>
                                    <td>@item.Status.Status1.ToUpper()</td>
                                    <td>@item.Age</td>
                                    <td class="text-right">
                                        <div class="pull-right">
                                            @if (item.StatusID != 1 && item.StatusID != 3)
                                            {
                                                <a href="@Url.Action("ReplaceForm", "Clothing", new { id = item.ID})" id="replace-roll" class="btn btn-success btn-sm" title="Replace Clothing/Roll"><i class="fas fa-exchange-alt mx-2"></i></a>
                                            }
                                            <a href="~/Clothing/Details/@item.ID" class="btn btn-info btn-sm" title="Details"><i class="fas fa-info-circle"></i></a>
                                            <a href="~/Clothing/Edit/@item.ID" class="btn btn-warning btn-sm" title="Edit"><i class="fas fa-pencil-alt"></i></a>
                                            <a href="~/Clothing/Delete/@item.ID" class="btn btn-danger btn-sm" title="Delete"><i class="fas fa-trash-alt"></i></a>
                                        </div>


                                    </td>

                                </tr>
                            }
                        }
                    </tbody>

                </table>

            </div>
        </div>
    </div>
</div>

@section Scripts
{
    <script>
        $(document).ready(function () {
            'use strict';
            $('#inventory_table').dataTable({
                dom: 'Bfrtip',
                buttons: [
                    'pdfHtml5',
                    'excel'
                ]
            }

            );

            $('#audit-report-btn').click(function (e) {
                e.preventDefault();
                $.ajax({
                    url: "Reports/CreateInventoryAuditReport",
                    success: function (response) {
                        window.open("Content/Reports/" + response);
                    }
                });
            })
        });

    </script>
}